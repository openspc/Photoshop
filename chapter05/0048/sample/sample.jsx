// 指定した名前のレイヤーを取得するvar lay1 = getLayerNameList("テロップ");alert("テロップという名前のレイヤーは"+lay1.length+"個ありました");var lay2 = getLayerNameList("背景");alert("背景という名前のレイヤーは"+lay2.length+"個ありました");var lay3 = getLayerNameList("タイトル");alert("タイトルという名前のレイヤーは"+lay3.length+"個ありました");// 指定した名前のレイヤーオブジェクトを配列で返す// IN : 取得するレイヤー名（文字列）// OUT : 指定した名前を持つレイヤーオブジェクトを格納した配列function getLayerNameList(layerName){    var list = getAllLayer(app.activeDocument, []);    var result = [];    // 結果を入れる配列    for(var i=0; i<list.length; i++){        if (list[i].name == layerName){            result.push(list[i]);        }    }    return result;    // レイヤーセットを除くすべてのレイヤーオブジェクトを取得する    // IN : レイヤーオブジェクト, 配列オブジェクト    // OUT : レイヤーオブジェクトを格納した配列オブジェクト    function getAllLayer(obj, ary){        for(var i=0; i<obj.layers.length; i++){            if (obj.layers[i].kind){    // レイヤーセット以外の場合                ary.push(obj.layers[i]);            }else{  // レイヤーセットなので再帰                getAllLayer(obj.layers[i], ary);            }        }        return ary; // 結果は配列で返す    }}