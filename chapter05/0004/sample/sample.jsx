// 選択されているレイヤー一覧を表示するvar layerList = getSelectLayer();if(layerList == null){    alert("背景が選択されていると処理できません");}else{    alert(layerList);}// 選択された複数のレイヤー／レイヤーセットを配列で返すfunction getSelectLayer(){    // 選択されたレイヤー／レイヤーセットをレイヤーセットに入れる    var idMk = charIDToTypeID( "Mk  " );        var desc1 = new ActionDescriptor();        var idnull = charIDToTypeID( "null" );            var ref1 = new ActionReference();            var idlayerSection = stringIDToTypeID( "layerSection" );            ref1.putClass( idlayerSection );        desc1.putReference( idnull, ref1 );        var idFrom = charIDToTypeID( "From" );            var ref2 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref2.putEnumerated( idLyr, idOrdn, idTrgt );        desc1.putReference( idFrom, ref2 );        var idUsng = charIDToTypeID( "Usng" );            var desc2 = new ActionDescriptor();            var idNm = charIDToTypeID( "Nm  " );            desc2.putString( idNm, "tempLayer" );        var idlayerSection = stringIDToTypeID( "layerSection" );        desc1.putObject( idUsng, idlayerSection, desc2 );    try{        executeAction( idMk, desc1, DialogModes.NO );    }catch(e){        return null;    // 背景ならnullを返す    }    // 選択されたレイヤーを配列に入れる    var result = [];    var ls = app.activeDocument.activeLayer;    for(var i=0; i<ls.layers.length; i++){        result.push(ls.layers[i]);    }    // 元に戻す    executeAction(charIDToTypeID("undo"), undefined, DialogModes.NO);    return result;}