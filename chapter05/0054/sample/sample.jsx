// テキストレイヤーのラベルカラーを赤色にするvar list = getAllLayer(app.activeDocument, []); // すべてのレイヤーを取得するfor(var i=0; i<list.length; i++){    if (list[i].kind == LayerKind.TEXT){        app.activeDocument.activeLayer = list[i];   // レイヤーをアクティブにする        setLayerColor("赤色");    }}// レイヤーセットを除くすべてのレイヤーオブジェクトを取得する// IN : レイヤーオブジェクト, 配列オブジェクト// OUT : レイヤーオブジェクトを格納した配列オブジェクトfunction getAllLayer(obj, ary){    for(var i=0; i<obj.layers.length; i++){        if (obj.layers[i].kind){    // レイヤーセット以外の場合            ary.push(obj.layers[i]);        }else{  // レイヤーセットなので再帰            getAllLayer(obj.layers[i], ary);        }    }    return ary; // 結果は配列で返す}// レイヤーのラベルカラーを設定するfunction setLayerColor(colorName){    var list = [        { name : "なし", value: "None" },        { name : "レッド", value: "Rd  " },        { name : "オレンジ", value: "Orng" },        { name : "イエロー", value: "Ylw " },        { name : "グリーン", value: "Grn " },        { name : "ブルー", value: "Bl  " },        { name : "バイオレット", value: "Vlt " },        { name : "グレー", value: "Gry " },        { name : "無色", value: "None" },        { name : "赤色", value: "Rd  " },        { name : "橙色", value: "Orng" },        { name : "黄色", value: "Ylw " },        { name : "緑色", value: "Grn " },        { name : "青色", value: "Bl  " },        { name : "紫色", value: "Vlt " },        { name : "灰色", value: "Gry " }    ];    var cName = "None"; // 無色に設定    for(var i=0; i<list.length; i++){        if (list[i].name == colorName){            cName = list[i].value;            break;        }    }    var idsetd = charIDToTypeID( "setd" );        var desc1 = new ActionDescriptor();        var idnull = charIDToTypeID( "null" );            var ref1 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref1.putEnumerated( idLyr, idOrdn, idTrgt );        desc1.putReference( idnull, ref1 );        var idT = charIDToTypeID( "T   " );            var desc2 = new ActionDescriptor();            var idClr = charIDToTypeID( "Clr " );            var idClr = charIDToTypeID( "Clr " );            var idRd = charIDToTypeID( cName ); // 色を設定            desc2.putEnumerated( idClr, idClr, idRd );        var idLyr = charIDToTypeID( "Lyr " );        desc1.putObject( idT, idLyr, desc2 );    try{        executeAction( idsetd, desc1, DialogModes.NO );    }catch(e){        alert("レイヤーパネルで何かレイヤーを選択してから実行してください");    }}